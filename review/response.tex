\documentclass[10pt]{scrartcl}

\usepackage{scrletter}
\usepackage{parskip}

\usepackage[table]{xcolor}
\usepackage{adjustbox}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{bookmark}
\usepackage{booktabs}
\usepackage[american]{circuitikz}
\usepackage{cite}
\usepackage{fixmath}
\usepackage[acronym]{glossaries-extra}
\usepackage{hyperref}
\usepackage{import}
\usepackage{mathtools}
% \usepackage{microtype}
\usepackage[short]{optidef}
\usepackage{pgfplots}
\usepackage{ragged2e}
\usepackage[subtle]{savetrees}
\usepackage{setspace}
\usepackage{siunitx}
\usepackage{stfloats}
\usepackage[caption=false,font=footnotesize,subrefformat=parens,labelformat=parens]{subfig}
\usepackage{tabularx}
\usepackage{tikz}

\usepackage[pagewise]{lineno}
\usepackage{xr}
\externaldocument[m-]{../main}

% letter signature
\renewcommand*{\raggedsignature}{\raggedright}

% line referencing
\newcommand{\R}[1]{\label{#1}\linelabel{#1}} % use this to set the placement of the line reference tags
\newcommand{\lr}[1]{page~\pageref{#1}, line~\lineref{#1}} % use this to reference the tags (print line numbers)

% quoting
\newcommand\declquotedtext[2]{\expandafter\def\csname quotedtext@#1 \endcsname{#2}} % use around text you may want to quote later, but don't want printed in the main text
\newcommand\defquotedtext[2]{\declquotedtext{#1}{#2}#2} % use around text you want to appear in the main text and that you want to quote later
\newcommand\usequotedtext[1]{\csname quotedtext@#1 \endcsname} % use to print the quoted text
\newcommand{\q}[1]{“#1”} % easier way to get double quotes

\usepackage{geometry}
\usepackage[most]{tcolorbox}

% Colors
\definecolor{lightgray}{rgb}{0.9, 0.9, 0.9}
\definecolor{lightyellow}{rgb}{0.98,0.91,0.71}
\definecolor{lightred}{rgb}{0.8,0.4,0.4}

% Boxes
\newtcolorbox{replybox}{colback=lightgray, grow to right by=-2.5mm, grow to
	left by=-2.5mm, boxrule=0pt, boxsep=0pt, breakable, before skip=10pt}
\newtcolorbox{partialbox}{colback=lightyellow, grow to right by=-2.5mm, grow to
	left by=-2.5mm, boxrule=0pt, boxsep=0pt, breakable, before skip=10pt}
\newtcolorbox{todobox}{colback=lightred, grow to right by=-2.5mm, grow to left
	by=-2.5mm, boxrule=0pt, boxsep=0pt, breakable, before skip=10pt}

% Counters
\newcounter{epntcnt}
\newcounter{rpntcnt}
\newcounter{revcnt}

% Environments
\newenvironment{reviewer}{%
	\refstepcounter{revcnt}%
	\setcounter{rpntcnt}{0}%
	\section*{Reviewer \therevcnt}%
}{}
% Editor environment takes an optional argument
\newenvironment{editor}[1][Editorial Decision]{%
	\setcounter{epntcnt}{0}%
	\section*{#1}%
}{}

% Reply Commands
\newcommand{\reply}[1]{%
	\begin{replybox}%
		#1
	\end{replybox}%
}
\newcommand{\partialreply}[1]{%
	\begin{partialbox}%
		Partial reply: \emph{#1}
	\end{partialbox}%
}
\newcommand{\todoreply}[1]{%
	\begin{todobox}%
		Todo reply: \emph{#1}
	\end{todobox}%
}
\newcommand{\needsreply}{%
	\todoreply{This comment needs a reply.}%
}

% Point command differs depending on the environment
\makeatletter
\newcommand{\point}{%
	\medskip\noindent%
	\def\@tmp{editor}%
	\ifx\@tmp\@currenvir \refstepcounter{epntcnt}\theepntcnt\textbf{.}
	\else%
	\def\@tmp{reviewer}%
	\ifx\@tmp\@currenvir \refstepcounter{rpntcnt}\therpntcnt\textbf{.}
	\else\fi\fi%
}
\makeatother

% Renew the commands for the point counters to get the formatting we want in
% both the references and the item labels.
\renewcommand{\therpntcnt}{\textbf{\textup{\therevcnt.\arabic{rpntcnt}}}}
\renewcommand{\theepntcnt}{\textbf{\textup{E.\arabic{epntcnt}}}}

\setlength\parindent{0pt}
\newcommand{\bft}[1]{\mathbf{#1}}


\begin{document}

\setkomavar{date}{\today}
\setkomavar{signature}{Yang Zhao and Bruno Clerckx}
\setkomavar{subject}{Re: Major revision of manuscript JSAC-SI-ESIT-1570874111}

\begin{letter}{%
		Guest Editors\\
		IEEE Journal on Selected Areas in Communications
	}
	\opening{Dear Editors and Reviewers,}
	Thank you for giving us the opportunity to submit a revised version of ``RIScatter: Unifying Backscatter Communication and Reconfigurable Intelligent Surface''.
	We would like to express our sincere gratitude to you for the valuable comments and suggestions, which helped us improve the quality of the manuscript significantly.
	Below, we prepare a point-to-point response and describe all the changes made to the manuscript.
	We hope that the revisions and clarifications make the manuscript meet the standards of JSAC publications.
	\closing{Yours sincerely,}
\end{letter}

\begin{reviewer}
	This paper introduces the concept of RIScatter, a unified architecture that combines Backscatter Communication (BackCom) and Reconfigurable Intelligent Surface (RIS) technologies, where the scatter nodes can modulate their own information and in the same time manipulate the wireless channel based on the information source, channel state information (CSI), and quality of service (QoS). The achievable primary-total-backscatter rate region in a single-user multi-node RIScatter system is investigated by designing the input distribution at scatter nodes, the active beamforming at the Access Point (AP), and the energy decision regions at the user. Numerical results show that RIScatter nodes can effectively utilize the scattered paths, enabling seamless transitions between backscatter modulation and passive beamforming techniques.

	Although the paper presents a novel idea and tackles an interesting problem, it requires great effort to improve the presentation, the language, and the mathematical derivations. Detailed comments are given as follows:

	\point The abstract and the number of keywords exceed the specified authorized limit. Please check IEEE JSAC guidelines.
	\reply {We apologize for the mistake. The abstract and keywords have been refined to meet the specifications.}

	\point The manuscript contains multiple grammatical errors and unclear sentences that require correction. Please revise the manuscript for improved clarity. For instance, in the first paragraph of Section II, Subsection B, the sentence "It is assumed that the signal reflected by two or more times is negligible" is not clear.
	\reply {We have thoroughly revised the manuscript to address the grammatical errors and improve sentence clarity. The example sentence has been revised to ``It is assumed that the signal going through two or more RIScatter nodes is too weak to be received by the user.''}

	\point Please consider defining all acronyms (e.g., MRC) and all the notations in Section I (e.g., the mutual information, probabilities, etc.,).
	\reply {Thank you for the suggestion and we understand it can be very difficult for readers to keep track of all acronyms and notations throughout the paper. Due to the space limitation, the list is not included but have carefully defined all acronyms and notations before their first usage. We appreciate your understanding in this matter.}

	\point Please ensure that all variables and symbols are properly defined and explained before their usage (e.g., $P$, $\sigma_1^2, \ldots, \sigma_L^2$, etc.). Also, $\mathbf{h}_E^H$ in eq. (46) is used without prior definition.
	\reply {The issue has been addressed in the revised manuscript. $\mathbf{h}_E^H$ in eq. (46) should be $\mathbf{h}^H$.}

	\point Please ensure consistency with the notation introduced in Section I throughout the manuscript. For instance, in Section II, Subsection B, after eq. (4b), the dimensions for $\mathbb{I}$ are not defined.
	\reply {We have revised the manuscript to ensure consistency with the notation introduced in Section~\ref{m-sc:introduction}. In this example, $\alpha_k \in \mathbb{I}$ refers to $\alpha_k \in \mathbb{I}^1$ and the $1$ was omitted for brevity.}

	\point To ensure consistency and clarity, please maintain uniformity in the usage of mathematical symbols and technical terms throughout the paper. For example, in eq. (3), the amplitude scattering ratio of the node is defined as $\beta_m$, while in eq. (4a), it is referred to as $\alpha_k$. Additionally, there is a discrepancy in the usage of the term 'node' throughout the manuscript and 'tag' in the appendix. Please use a consistent term to refer to the same entity throughout the entire paper to avoid confusion and improve clarity.
	\reply {Thank you for bringing this to our attention. We were trying to be rigorous and consistent with the notation used in the literature, but didn't realize the confusion it may cause to the readers. In BackCom literatures, $\alpha_k$ is a constant that measures the \emph{average} reflection efficiency (irrelevant to the state) for node $k$. In RIS literatures, $\beta_m$ measures the scattering ratio of one element at state $m$. In the revised manuscript, we have unified those notation in page~\pageref{m-eq:backscatter_modulation}, modified footnote~\ref{m-fn:scattering_ratio}, and revised the term ``tag'' to ``node'' in the appendix.}

	\point The expression in eq. (1) represents the conjugate of the reflection coefficient, not the reflection coefficient itself.
	\reply {After a careful investigation, we found there are at least three different definitions for the reflection coefficient in the literature:
		\begin{enumerate}
			\item $\Gamma_m = \frac{Z_m - Z^*}{Z_m + Z}$ in overview papers \cite{VanHuynh2017,Liang2022};
			\item $\Gamma_m = \frac{Z_m - Z^*}{Z_m + Z^*}$ in BackCom paper \cite{Boyer2014};
			\item $\Gamma_m^* = \frac{Z^* - Z_m}{Z + Z_m}$ in RF paper \cite{Hansen1989},
		\end{enumerate}
		where $Z_m$ is the load impedance at state $m$ and $Z$ is the antenna impedance.
		Unfortunately, we are not microwave engineering experts and have to guess that they may choose different parties (antenna and space) as reference. In the current version, we have not made any change to eq. (1) but would be grateful to hear your opinion on this issue.}

	\point It is unclear what is meant by relative QoS. Additionally, there is a lack of clarity regarding the derivation of eqs. (17-19) and how the relative QoS of the primary link is incorporated in those equations. The defined expressions should be clearly explained and justified. Please provide additional details and reasoning.
	\reply {We apologize for the confusion caused by poor wording. QoS refers to the relative priority of the primary link, and it should be either ``QoS'' or ``relative priority''. We have added footnote \ref{m-fn:qos} on this. Besides, the information theory subsection (including the derivation of eqs. (17-19)) has been rewritten and incorporated into Section~\ref{m-sc:system_model} with proper explanation. We also modified Remark \ref{m-re:dynamic_passive_beamforming} and added Remark \ref{m-re:independent_encoding} to clarify the derivation of achievable rates. Please see page~\pageref{m-re:dynamic_passive_beamforming}--\pageref{m-eq:weighted_sum_mutual_information} for details.}

	\point The link between eq. (9) and eq. (25) lacks clarity and misses intermediate steps. Also, the expression of the function $Q$ provided in eq. (25) appears to be independent of the active beamforming $\boldsymbol{w}$.  It is unclear how the derivation of $Q$ with respect to $\boldsymbol{w}$ is performed in this case. Please clarify the relationship between $Q$ and $\boldsymbol{w}$ and provide a clear derivation for better understanding. The same remark about clarity applies to eq. (28) and eq. (33).
	\reply {
		Plugging the conditional energy PDF into the DMMAC expression, we have
		\begin{equation}
			q(x_l|x_{m_{\mathcal{K}}}) = \frac{\int_{{t_{l-1}}/{\sigma_{m_{\mathcal{K}}}^2}}^{{t_l}/{\sigma_{m_{\mathcal{K}}}^2}} z^{N-1} \exp(-z) \, d z}{(N-1)!} = Q\Bigl(N,\frac{t_{l-1}}{\sigma_{m_{\mathcal{K}}}^2},\frac{t_l}{\sigma_{m_{\mathcal{K}}}^2}\Bigr),
			\label{eq:dmmac_gamma}
		\end{equation}
		where $Q(N, b_1, b_2) \triangleq \int_{b_1}^{b_2} z^{N-1} \exp(-z) / (N - 1)! \, d z$ is the regularized incomplete Gamma function.
		$Q\Bigl(N,\frac{t_{l-1}}{\sigma_{m_{\mathcal{K}}}^2},\frac{t_l}{\sigma_{m_{\mathcal{K}}}^2}\Bigr)$ depends on the variance of accumulated receive energy $\sigma_{m_{\mathcal{K}}}^2$, which is a function of $\boldsymbol{w}$.
		Its series expansion is given by \cite[Theorem 3]{Jameson2016}
		\begin{equation}
			Q\Bigl(N,\frac{t_{l-1}}{\sigma_{m_{\mathcal{K}}}^2},\frac{t_l}{\sigma_{m_{\mathcal{K}}}^2}\Bigr) = \exp \Bigl(-\frac{t_{l-1}}{\sigma_{m_{\mathcal{K}}}^2}\Bigr) \sum_{n=0}^{N-1} \frac{\bigl(\frac{t_{l-1}}{\sigma_{m_{\mathcal{K}}}^2}\bigr)^n}{n!} - \exp \Bigl(-\frac{t_l}{\sigma_{m_{\mathcal{K}}}^2}\Bigr) \sum_{n=0}^{N-1} \frac{\bigl(\frac{t_l}{\sigma_{m_{\mathcal{K}}}^2}\bigr)^n}{n!}.
			\label{eq:regularized_incomplete_gamma}
		\end{equation}
		In the revised manuscript, we have added the intermediate steps from (9) to (25) in page~\pageref{m-eq:dmmac_gamma} with proper details. The corresponding part has been completely rewritten to improve logic and clarity.}

	\point Is the BCD algorithm convergent for the optimization problem (20)?
	\reply {The BCD algorithm is convergent for the optimization problem (20), since the input distribution and active beamforming subproblems converge and the thresholding subproblem attains global optimality. This argument has been added in the discussion of Fig.~\ref{m-fg:wsr_convergence}.}

	\point Please write the mathematical expression of eq. (40) properly. Moreover, there appears to be a mistake in the sign of the Lagrangian function of the optimization problem stated in Equation (21). If the optimization problem is intended to be a minimization problem, it should be explicitly mentioned to avoid any ambiguity or confusion.
	\reply {Problem (21) is a maximization problem and the Lagrangian function (40) has been rewritten as
		\begin{equation}
			I(x_{\mathcal{K}}) + \sum_k \nu_k \biggl( \sum_{m_k} p(x_{m_k}) - 1 \biggr) + \sum_k \sum_{m_k} \lambda_{m_k} p(x_{m_k}).
		\end{equation}
	}

	\point The expression of the primary achievable rate in eq. (37) seems to be wrong since the primary message is also included in the cascaded channel and cannot be ignored.
	\reply {We appreciate your careful reading. The primary message is indeed included in the scattered component. However, since the user decodes both links independently, the backscatter uncertainty cannot be eliminated when decoding the primary link. That is to say, the scattered component should be treated as interference with average power $\mathbb{E}\bigl\{\sum_{k} \alpha_k \boldsymbol{h}_{\text{C},k}^\mathsf{H} x_k \boldsymbol{w}s[n]\bigr\} = \sum_{k} \lvert \alpha_k \boldsymbol{h}_{\text{C},k}^\mathsf{H} \boldsymbol{w} \rvert^2$. The same reasoning was considered in \cite{Long2020a}. We have revised the corresponding footnote \ref{m-fn:ambc} to justify this.}

	\point In Figure 7, it is unclear why the KKT, PGD, and BCD algorithms are plotted separately since the BCD algorithm encompasses both the KKT and PGD algorithms. If there is a specific reason for displaying them separately, please provide a justification to enhance the understanding of the reader. Additionally, please provide the unit for the weighted sum rate axis.
	\reply {In company with BCD, we also plotted the convergence results of KKT and PGD algorithms to show how much performance gain is provided by solving each subproblem (over the initialization method specified in the previous paragraph). We have justified this in Section~\ref{m-sc:convergence}. The unit of the y axis of Fig.~\ref{m-fg:distribution_weights} has been specified as bit/s/Hz.}

	\point Is the decoding of the backscatter information based on an energy detector reliable in this case, especially with high-order modulation or large number of scatter nodes? In other words, can the user in practice decode the backscatter information especially in the presence of the noise and signal variations due to the fading or the interference, etc.?
	\reply {The energy detector is a simple and practical method for backscatter information decoding, and its reliability is improved by the adaptive input distribution and thresholding design. With high-order modulation or large number of scatter nodes, its performance can be further enhanced by increasing the spreading factor $N$ or using stronger error correction codes with lower code-rate. In practice, the user can decode backscatter nodes ranging from few to hundreds of meters in the presence of noise and interference, and the backscatter throughput can reach few Kbps to tens of Mbps. We have added footnote \ref{m-fn:energy_detector} on this issue, and the reviewer is referred to Table II in \cite{Wu2022e} for more details.}

	\point In Section III, the aim is to characterize the primary-total-backscatter rate region where the user retrieves both the backscatter information and the primary message. Why is the weighted sum mutual information maximized with respect to only the input distribution of the backscatter information and not jointly with respect to the input distribution of the primary message `s' as well? In other words, is the choice of $s \sim \mathcal{CN} (0,1)$ optimal?
	\reply {This is indeed a very good question. The choice of $s \sim \mathcal{CN} (0,1)$ is generally not optimal for weighted sum mutual information. To the best of our knowledge, the optimal primary distribution in this case remains an open issue, but some insights were given in these papers:
		\begin{itemize}
			\item If there is no direct link and the node is with \emph{average} power constraint, then the optimal distribution for \emph{weighted sum mutual information} requires a time-sharing between these modes \cite{Pillai2011}:
			\begin{itemize}
				\item $s$ follows zero-mean Gaussian distribution and $x$ is a constant;
				\item $x$ follows zero-mean Gaussian distribution and $s$ is a constant;
				\item $s$ and $x$ equal 0.
			\end{itemize}
			\item If there is no direct link and the node is with \emph{peak} power constraint, then the optimal distribution for \emph{sum mutual information} is not unique, for example \cite{Zhang2023} (came out after our submission):
			\begin{itemize}
				\item $s$ follows zero-mean Gaussian distribution and $x$ is a constant;
				\item $s$ follows Rayleigh distribution and $x$ follows uniform distribution on $[0, 2 \pi)$;
			\end{itemize}
		\end{itemize}
		Despite not optimal, the assumption of Gaussian primary source and finite-support backscatter source are relatively practical and widely adopted in relevant literatures. We have added Remark~\ref{m-re:non_gaussian} on this, but intentionally avoided the discussion of optimal distribution, since it is beyond the scope of this paper and may confuse the readers. We appreciate your understanding in this matter.}

	\point In Section IV, Subsection B, it is stated that the RIS always ensures constructive superposition of direct and scattered components which is not true. The RIS can also add those components destructively which could be used for example to enhance the physical layer security of a system in the presence of an eavesdropper.
	\reply {We apologize for the oversight. The argument has been modified to ``Here, RIS ensures constructive superposition of direct and scattered components.''}
\end{reviewer}

\begin{reviewer}
	The paper studies the achievable rates for both primary transmission and backscatter information, assuming a Gaussian distribution for primary transmission and $K$ tags (with $M$ loads each) and a single source-destination primary link; the authors assume full CSI knowledge and formulate a mutual information maximization problem, with probability distribution of loads per tag as a function to be optimized (in conjunction with beamforming weights for the multi-antenna transmitter and energy thresholds for the energy-based detector for the backscatter information). The problem is non-convex and challenging, and the authors revert to a series of approximations to relax it and offer a solution. The methodology is interesting in two ways: a) the authors do not employ SIC, but instead focus first on the tags' (weak) information signal, since its knowledge renders the detection of the primary information as a simple coherent detection problem, and b) borrow techniques from the discrete memoryless MAC/discrete memoryless thresholding channel literature, in order to calculate the average rate of the backscattered information.

	The authors balance rate of primary transmission with rate of backscattered tags in a unified, user-controlled way and offer comparison results with prior art in the field (e.g., bistatic backscatter, where no primary link information is present, ambient backscatter, symbiotic (cooperative) ambient backscatter and RIS). Of particular importance is the fact that the authors have modeled both small-scale (through Rice) and large-scale (through distance) fading link parameters, typically omitted in many comm theory papers, even though backscattered links are operating in the presence of the much stronger primary link.

	Overall, the methodology and overall presentation is rigorous and deserves further attention. Having said that, the following remarks are offered:

	\point CSI estimation impact: the notion of full and perfect CSI knowledge is a very strong assumption; the authors do point at footnote 4, page 8 (single column version) to CSI estimation literature. However, CSI estimation for ambient backscatter employs several assumptions and simplifications and it is not perfect or ideal. The authors should perhaps study in terms of simulations the impact of imperfect CSI and necessary degrees of freedom (for channel estimation) on the achieved rates, carefully taking into account the tag(s) small SNR as well as the primary link much stronger SNR.
	\reply {We agree with the reviewer that the assumption of perfect CSI is very strong. Fast and accurate acquisition of cascaded CSI can be challenging especially when the backscatter SNR is weak and/or the number of nodes is large. To investigate the impact of CSI estimation error on the system performance, we have applied the proposed algorithms to an imperfect CSI model, where the cascaded channel of node $k$ is estimated as
		\begin{equation}
			\hat{\boldsymbol{h}}_{\text{C},k} = \boldsymbol{h}_{\text{C},k} + \tilde{\boldsymbol{h}}_{\text{C},k},
		\end{equation}
		$\tilde{\boldsymbol{h}}_{\text{C},k}$ is the estimation error with entries following i.i.d. CSCG distribution $\mathcal{CN}(0, \iota \Lambda_\text{C})$, $\iota$ is the relative estimation error, and $\Lambda_\text{C}$ is the cascaded path loss.
		In Fig.~\ref{fg:region_csi}, it is observed that the channel estimation error mainly affects the backscatter rate.
		When $\iota$ increases from \num{0} to \num{0.2}, the maximum total backscatter rate decreases by \qty{20}{\percent}.
		This is because the energy detector is sensitive to the DMMAC and thus $\hat{\boldsymbol{h}}_{\text{C},k}$.
		On the other hand, a small estimation error may be insufficient to change the optimal passive beamforming state (especially for a small $M$) and the primary rate is almost unchanged in this case.
		We have added the result and discussion on imperfect CSI in page~\pageref{m-fg:region_csi}.
	}
	\begin{figure}[!t]
		\centering
		\resizebox{0.48\columnwidth}{!}{
			\input{../assets/simulation/region_csi.tex}
		}
		\caption{
			Average primary-total-backscatter rate regions vs imperfect cascaded CSI.
		}
		\label{fg:region_csi}
	\end{figure}

	\point Modeling assumptions: the overall model is based on Gaussian codebooks for the primary link and lack of structural mode for backscattering; the latter is assumed absorbed by the channel parameters (Section II.A), while the tags are assumed with a demodulator/receiver of the primary information; it is also assumed that both full CSI and reflection efficiency parameters $\{\alpha_k\}, k \in \{1, 2, \ldots, K\}$ are known for all tags, while each tag is equipped with a receiver/demodulator (for the primary information). The reviewer believes that the structural mode cannot be absorbed by the channel parameters, since it offers a DC term, while there is no practical way to estimate separately the cascaded channel from the reflection efficiency; moreover, receivers in tags either increase the complexity or reduce the tag's sensitivity, especially when envelope detectors are used (as in Fig. 3). Moreover, the assumption for perfect symbol-level synchronization between tags and source, or the integer ratio between tags and source symbol duration is also very strong. Some discussion on the above is necessary, while some thoughts on non-Gaussian codebooks and how the methodology could be extended is perhaps important.
	\reply {Your valuable comments on scatter modeling and codebook design are very much appreciated. When the transmitted waveform is a continuous carrier wave (CW) that carries no information, the structure mode component is also a CW. After downconversion, its contribution is indeed modelled as a DC offset \cite{Boyer2014}. However, when the transmitted waveform is a modulated signal, the structure mode component is proportional to the modulated signal, and its contribution can thus be absorbed in the environment multipath \cite{Thomas2012,Liang2020}. When estimating the cascaded CSI, the reflection efficiency $\{\alpha_k\}$ can be set to some pre-determined values, such that the cascaded channels can be separated from the reflection efficiency. We agree with the reviewer that adding integrated receivers will increase the complexity and reduce the sensitivity of the nodes. The aim is to coordinate the nodes with the active source and to acquire the optimized input distributions, instead of decoding the primary information dedicated for the user. Thus, those receivers can be implemented using very simple circuits or even integrated with the rectifier \cite{Kim2021a} to reduce cost and complexity. Besides, the assumption of perfect symbol-level synchronization and integer spreading ratio are made to simplify the achievable rate analysis, and they have been widely adopted in relevant literatures \cite{Liang2020,Ding2020,Long2020a,Guo2019b,Han2021,Zhang2022}. If they are not satisfied, some penalty can be introduced to the achievable rate and it is left for future work. We have incorporated the above discussions in footnote \ref{m-fn:integrated_receiver}.}

	\point Independent distributions across tags: (10) assumes independence among distributions of tag loads across tags; IV.D.1 talks about joint nodes encoding; pls clarify. In addition, some more discussion is needed at IV.C and Fig. 9; for $\rho=1$, i.e., primary transmission maximum prioritization, Fig. 9 shows that only one load (out of 4) should be used. The reviewer was puzzled by this. Perhaps, values of the loads used in the simulations and respective reflection coefficients should be explicitly offered, in conjunction with more discussion regarding the wireless channel impact. When the channel changes, one would expect the distribution of the tags' loads to be sensitive on channel statistics.
	\reply {We apologize for the confusion caused by poor writing. The achievable rate analysis and the algorithms are provided for the most general case where all nodes encode independently. When multiple nodes are co-located, they can jointly encode by designing the joint probability $p(x_{m_{\mathcal{K}}})$ directly. This formulates an augmented backscatter source and becomes a special case of independent encoding. In the revised manuscript, we have clarified the above points in Remark~\ref{m-re:augmented_source} and footnote~\ref{m-fn:joint_encoding}. Regarding the observation in Fig. 9, please note that one state corresponds to one equivalent load (and one reflection coefficient). In this case, there is exactly one reflection coefficient (corresponds to state 3) that maximizes the primary SNR, and it should be used with probability 1 to maximize the primary rate. Instead of explicitly designing the value of load impedance, we assume that they have been designed to fulfill the reflection coefficient codebook. The node input distribution (not the reflection coefficient codebook) is indeed adaptive to CSI, as mentioned in Section~\ref{m-sc:input_distribution}. We have clarified the above points in the revised manuscript.}

	\point All simulation results and respective optimization solutions are offered with relatively small number of K and M; some discussion on ways to extend the methodology for larger networks and loads should be helpful.
	\reply {Thank you for the suggestion. The main limitations for massive RIScatter are the energy detection and the dynamic programming algorithm. For $K$ nodes each with $M$ states, there are a total of $L = M^K$ energy decision regions to design. The candidate threshold set $\mathcal{T}$ should be even finer, which results in a very fast growth of the computational complexity ($\mathcal{O}\bigl(L^2(\mathrm{card}(\mathcal{T})-L)\bigr)$ for SMAWK and $\mathcal{O}\bigl(\mathrm{card}(\mathcal{T})L\log(\mathrm{card}(\mathcal{T})L)\bigr)$ for bisection). To support massive RIScatter networks with large number of nodes and states, one possible future direction is to consider backscatter detection over the received signal domain rather than energy domain, where multi-antenna \cite{Liu2022c} and learning-based approaches can be promising. We have added this to Section~\ref{m-sc:conclusion} of the revised manuscript.}

	\point Finally, the list of references is perhaps incomplete; many references do not include publication venues, while prior art backscatter radio, including coherent as well as non-coherent detection, structural mode, receiverless tags etc., both in terms of theory as well as experimentation, are not given. For example see work that bridges backscatter radio and RIS, including theory and experimental results for any number of tags and loads in the following: "Intelligently Wireless Batteryless RF-Powered Reconfigurable Surface: Theory, Implementation \& Limitations", IEEE Transactions on Wireless Communications (TWC), available as early access in ieeexplore, Nov. 2022, conference version available at IEEE Globecom 2021.
	\reply {We agree with the reviewer that the reference list could be improved. The current state of the art in BackCom is indeed very rich and diverse.  In the previous version of our manuscript, we only introduced papers that use RIS for backscatter modulation. In contrast, the recommended reference exploits commodity RFID tags, powered and controlled by a software-defined radio reader, to perform passive beamforming towards a legacy user at a different frequency. It validates the feasibility of using batteryless devices to adaptively enhance the SNR of the primary link. This reference makes the literature review more comprehensive, and we have added it in page~\pageref{m-cm:2.5} of the revised manuscript.}
\end{reviewer}

\begin{reviewer}
	This paper introduces the concept of RIScatter, a unified architecture that combines Backscatter Communication (BackCom) and Reconfigurable Intelligent Surface (RIS) technologies, where the scatter nodes can modulate their own information and in the same time manipulate the wireless channel based on the information source, channel state information (CSI), and quality of service (QoS). The achievable primary-total-backscatter rate region in a single-user multi-node RIScatter system is investigated by designing the input distribution at scatter nodes, the active beamforming at the Access Point (AP), and the energy decision regions at the user. Numerical results show that RIScatter nodes can effectively utilize the scattered paths, enabling seamless transitions between backscatter modulation and passive beamforming techniques.

	The manuscript presents a novel concept, i.e., RIScatter, and studies an interesting problem. However, there are several problems with the manuscript, namely:

	\point Presentation and use of English: the presentation is sometimes unclear about the differences of RIScatter and existing techniques, it seems that the authors are concerned about listing the contributions in the introduction and forgot to contrast the key differences between existing approaches and the proposed RIScatter. Perhaps the authors can polish this part and make it more compact. Sometimes, a shorted and compact text can be made easier to understand. Moreover, there are too many poorly written sentences, typos and Grammar errors throughout the manuscript. It is not acceptable that a JSAC paper would feature with this level of English (especially coming from a British university!). Therefore, it is fundamental to improve the use of English and make sentences properly structured.
	\reply {We agree with the reviewer that the contrast between RIScatter and existing techniques could be clearer. The introduction and contribution have been refined in precise and explicit words for improved readability and clarity. Also, we have completely rewritten Section~\ref{m-sc:principles} on RIScatter principles to highlight the key differences between RIScatter and existing techniques. Remark~\ref{m-re:dynamic_passive_beamforming} now emphasizes the distinction and relationship between RIScatter and dynamic RIS. We also apologize for the poor English usage. The manuscript has been carefully proofread and revised to address the typos and grammar errors. We believe that the revised manuscript should be much easier to understand.}

	\point Literature review: the literature review on rate characterization for backscatter communications is deficient. Some recent and closely related works are missing:
	\begin{itemize}
		\item J. Qian, Y. Zhu, C. He, F. Gao and S. Jin, "Achievable Rate and Capacity Analysis for Ambient Backscatter Communications," in IEEE Transactions on Communications, vol. 67, no. 9, pp. 6299-6310, Sept. 2019.
		\item Z. Dai, R. Li, J. Xu, Y. Zeng and S. Jin, "Rate-Region Characterization and Channel Estimation for Cell-Free Symbiotic Radio Communications," in IEEE Transactions on Communications, vol. 71, no. 2, pp. 674-687, Feb. 2023.
		\item H. E. Hassani, A. Savard, E. V. Belmega and R. C. de Lamare, "Multi-user downlink NOMA systems aided by ambient backscattering: achievable rate regions and energy-efficiency maximization," in IEEE Transactions on Green Communications and Networking, 2023.
	\end{itemize}
	\reply {We appreciate your insightful comments on the reference list. Those papers have been incorporated into the literature review.}

	\point Technical aspects: RIScatter is able to balance rate of primary transmission with rate of backscattered tags in a unified, user-controlled way, which brings technical advantages over existing approaches. This reviewer wonders why the authors only considered perfect CSI and did not assessed the impact of imperfect CSI on information rates (not the region!) given the limitations of tags and devices. Moreover, this reviewer is also sceptical about the assumption of perfect synchronization between the tags and the source. Can you explain why this is reasonable?
	\reply {Please kindly refer to response 2.1 for the discussion on imperfect CSI and response 2.2 for the discussion on perfect synchronization.}

	\point Simulation results: the authors opted for showing the results in terms of rate regions for several existing schemes and the proposed RISscatter. This is not properly motivated. Could explain why not include results such as information rates versus SNR or BER versus SNR?
	\reply {Thank you for the suggestion. In the previous version of the manuscript, we showed the impact of average noise power and disk radius on the achievable rate region. The former influences both primary and backscatter SNR, while the latter implicitly influences the backscatter SNR. In the revised manuscript, we have added explicit results on the achievable region vs primary SNR and backscatter SNR.
		Interestingly, Fig.~\subref*{fg:region_snr_primary} shows that increasing the primary SNR can improve the primary rate but degrade the backscatter rate.
		The reason is that the relative strength of the scattered signal compared to the direct signal is weakened, such that the nodes cannot make enough difference to the energy detector.
		This emphasizes the importance of accounting the primary-backscatter tradeoff in active-passive coexisting networks.
		Fig.~\subref*{fg:region_snr_backscatter} shows that the primary and backscatter rates are both improved when the backscatter SNR increases.
		This motivates one to use high-efficiency or semi-passive RIScatter nodes to improve the overall performance.
		In a multi-user RIScatter network, each node may be assigned to the nearest user to guarantee uniformly good performance for both links.
		The above results are added to Section~\ref{m-sc:simulation_results}.
		However, we do not include BER vs SNR because we have reached the page limit and the BER performance is not the focus of this paper. We appreciate your understanding in this matter.}

	\begin{figure}[!t]
		\centering
		\subfloat[Primary SNR\label{fg:region_snr_primary}]{
			\resizebox{0.48\columnwidth}{!}{
				\input{../assets/simulation/region_snr_primary.tex}
			}
		}
		\subfloat[Backscatter SNR\label{fg:region_snr_backscatter}]{
			\resizebox{0.48\columnwidth}{!}{
				\input{../assets/simulation/region_snr_backscatter.tex}
			}
		}
		\label{fg:region_config}
	\end{figure}
\end{reviewer}

\bibliographystyle{IEEEtran}
\bibliography{../library.bib}
\end{document}
